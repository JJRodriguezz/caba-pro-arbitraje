<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <title>Cambiar Contraseña - CABA Pro</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{/css/perfil.css}" />
    <link rel="stylesheet" th:href="@{/css/formularios.css}" />
</head>
<body style="margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">

<div class="perfil-container">
    <!-- Header del formulario -->
    <div class="perfil-header">
        <h1>🔒 Cambiar Contraseña</h1>
        <p th:if="${esAdmin}" class="text-muted">Administrador del Sistema</p>
        <p th:if="${!esAdmin}" class="text-muted">Árbitro Profesional</p>
    </div>

    <!-- Mostrar errores -->
    <div th:if="${error}" class="alert alert-error">
        <span th:text="${error}"></span>
    </div>

    <!-- Formulario de cambio de contraseña -->
    <form th:action="${esAdmin ? '/admin/perfil/cambiar-password' : '/arbitro/perfil/cambiar-password'}" 
          th:object="${cambiarPassword}" 
          method="post">

        <div class="info-section">
            <div class="info-title">
                <span>🔐</span> Cambio de Contraseña
            </div>
            
            <div class="form-group">
                <label for="passwordActual">Contraseña Actual:</label>
                <input type="password" 
                       id="passwordActual" 
                       th:field="*{passwordActual}" 
                       class="form-control"
                       placeholder="Ingrese su contraseña actual"
                       required />
                <span th:if="${#fields.hasErrors('passwordActual')}" 
                      th:errors="*{passwordActual}" 
                      class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="passwordNueva">Nueva Contraseña:</label>
                <input type="password" 
                       id="passwordNueva" 
                       th:field="*{passwordNueva}" 
                       class="form-control"
                       placeholder="Ingrese la nueva contraseña (mínimo 6 caracteres)"
                       required />
                <span th:if="${#fields.hasErrors('passwordNueva')}" 
                      th:errors="*{passwordNueva}" 
                      class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="confirmarPassword">Confirmar Nueva Contraseña:</label>
                <input type="password" 
                       id="confirmarPassword" 
                       th:field="*{confirmarPassword}" 
                       class="form-control"
                       placeholder="Confirme la nueva contraseña"
                       required />
                <span th:if="${#fields.hasErrors('confirmarPassword')}" 
                      th:errors="*{confirmarPassword}" 
                      class="error-message"></span>
            </div>

            <div class="password-requirements">
                <h4>Requisitos de la contraseña:</h4>
                <ul>
                    <li>Mínimo 6 caracteres</li>
                    <li>Debe ser diferente a la contraseña actual</li>
                    <li>Las contraseñas deben coincidir</li>
                </ul>
            </div>
        </div>

        <!-- Botones de acción -->
        <div class="actions-section">
            <a th:href="${esAdmin ? '/admin/perfil' : '/arbitro/perfil'}" 
               class="btn btn-secondary">❌ Cancelar</a>
            <button type="submit" class="btn btn-primary">🔒 Cambiar Contraseña</button>
        </div>
    </form>
</div>

</body>
</html>
