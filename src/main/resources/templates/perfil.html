<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <title>[[#{perfil.titulo}]] - CABA Pro</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{/css/perfil.css}" />
    <link rel="stylesheet" th:href="@{/css/formularios.css}" />
</head>
<body style="margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">

<div class="perfil-container">
    <!-- Header del perfil -->
    <div class="perfil-header">
        <!-- Mostrar mensajes flash -->
        <div th:if="${success}" class="alert alert-success">
            <span th:text="${success}"></span>
        </div>
        <div th:if="${error}" class="alert alert-error">
            <span th:text="${error}"></span>
        </div>
        
        <div class="perfil-avatar">
            <span th:if="${perfil.isArbitro() and perfil.urlFotoPerfil != null}" style="display: flex; justify-content: center; align-items: center;">
                <img th:src="${perfil.urlFotoPerfil}" alt="Foto de perfil" style="width: 100px; height: 100px; object-fit: cover; border-radius: 50%; border: 3px solid #eee; background: #fff;" />
            </span>
            <span th:if="${perfil.isAdmin() and perfil.urlFotoPerfil != null}" style="display: flex; justify-content: center; align-items: center;">
                <img th:src="${perfil.urlFotoPerfil}" alt="Foto de perfil" style="width: 100px; height: 100px; object-fit: cover; border-radius: 50%; border: 3px solid #eee; background: #fff;" />
            </span>
            <span th:if="${perfil.isArbitro() and perfil.urlFotoPerfil == null}" th:text="${perfil.nombre != null ? #strings.substring(perfil.nombre, 0, 1) + #strings.substring(perfil.apellidos, 0, 1) : 'üë§'}"></span>
            <span th:if="${perfil.isAdmin() and perfil.urlFotoPerfil == null}" th:text="${perfil.username != null ? #strings.substring(perfil.username, 0, 1) : 'üîß'}"></span>
        </div>
        <h1 th:if="${perfil.isArbitro()}" th:text="${perfil.nombreCompleto}"></h1>
        <h1 th:if="${perfil.isAdmin()}" th:text="${perfil.username}"></h1>
        <p th:if="${perfil.isArbitro()}" class="text-muted" th:text="#{perfil.arbitro.profesional}">√Årbitro Profesional</p>
        <p th:if="${perfil.isAdmin()}" class="text-muted" th:text="#{perfil.administrador.sistema}">Administrador del Sistema</p>
    </div>

    <!-- Informaci√≥n del perfil -->
    <div class="perfil-info">
        <!-- Informaci√≥n Personal -->
        <div class="info-section" th:if="${perfil.isArbitro()}">
            <div class="info-title">
                <span>üë§</span> <span th:text="#{perfil.informacion.personal}">Informaci√≥n Personal</span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.nombre.completo}">Nombre Completo:</span>
                <span class="info-value" th:text="${perfil.nombreCompleto}"></span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.identificacion}">Identificaci√≥n:</span>
                <span class="info-value" th:text="${perfil.numeroIdentificacion}"></span>
            </div>
            <div class="info-item" th:if="${perfil.fechaNacimiento}">
                <span class="info-label" th:text="#{perfil.fecha.nacimiento}">Fecha de Nacimiento:</span>
                <span class="info-value" th:text="${#temporals.format(perfil.fechaNacimiento, 'dd/MM/yyyy')}"></span>
            </div>
        </div>

        <!-- Informaci√≥n de Contacto -->
        <div class="info-section" th:if="${perfil.isArbitro()}">
            <div class="info-title">
                <span>üìß</span> <span th:text="#{perfil.contacto}">Contacto</span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.email}">Email:</span>
                <span class="info-value" th:text="${perfil.email}"></span>
            </div>
            <div class="info-item" th:if="${perfil.telefono}">
                <span class="info-label" th:text="#{perfil.telefono}">Tel√©fono:</span>
                <span class="info-value" th:text="${perfil.telefono}"></span>
            </div>
        </div>

        <!-- Informaci√≥n Profesional para √Årbitros -->
        <div class="info-section" th:if="${perfil.isArbitro()}">
            <div class="info-title">
                <span>‚öΩ</span> <span th:text="#{perfil.informacion.profesional}">Informaci√≥n Profesional</span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.especialidad}">Especialidad:</span>
                <span class="info-value">
                    <span th:class="${perfil.especialidad == T(com.caba.caba_pro.enums.Especialidad).CAMPO} ? 'especialidad-badge especialidad-campo' : 'especialidad-badge especialidad-mesa'"
                          th:text="${perfil.especialidad?.descripcion}"></span>
                </span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.escalafon}">Escalaf√≥n:</span>
                <span class="info-value" th:text="${perfil.escalafon}"></span>
            </div>
        </div>

        <!-- Informaci√≥n del Sistema -->
        <div class="info-section">
            <div class="info-title">
                <span>‚öôÔ∏è</span> <span th:text="#{perfil.informacion.sistema}">Informaci√≥n del Sistema</span>
            </div>
            <div class="info-item" th:if="${perfil.isAdmin()}">
                <span class="info-label" th:text="#{perfil.usuario}">Usuario:</span>
                <span class="info-value" th:text="${perfil.username}"></span>
            </div>
            <div class="info-item" th:if="${perfil.isArbitro()}">
                <span class="info-label" th:text="#{perfil.usuario}">Usuario:</span>
                <span class="info-value" th:text="${perfil.username}"></span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.rol}">Rol:</span>
                <span class="info-value">
                    <th:block th:if="${perfil.isAdmin()}" th:text="#{perfil.rol.administrador}">Administrador</th:block>
                    <th:block th:unless="${perfil.isAdmin()}" th:text="#{perfil.rol.arbitro}">√Årbitro</th:block>
                </span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.estado}">Estado:</span>
                <span th:class="${perfil.activo} ? 'status-badge status-activo' : 'status-badge status-inactivo'">
                    <th:block th:if="${perfil.activo}" th:text="#{perfil.estado.activo}">Activo</th:block>
                    <th:block th:unless="${perfil.activo}" th:text="#{perfil.estado.inactivo}">Inactivo</th:block>
                </span>
            </div>
            <div class="info-item">
                <span class="info-label" th:text="#{perfil.miembro.desde}">Miembro desde:</span>
                <span class="info-value" th:text="${#temporals.format(perfil.fechaCreacion, 'dd/MM/yyyy HH:mm')}"></span>
            </div>
        </div>
    </div>

    <!-- Acciones -->
    <div class="actions-section">
        <a th:href="${perfil.isAdmin() ? '/admin/dashboard' : '/arbitro/dashboard'}" 
           class="btn btn-secondary">
            <span>üîô</span> <span th:text="#{perfil.volver.dashboard}">Volver al Dashboard</span>
        </a>
        <a th:href="${perfil.isAdmin() ? '/admin/perfil/editar' : '/arbitro/perfil/editar'}" 
           class="btn btn-primary">
            <span>‚úèÔ∏è</span> <span th:text="#{perfil.editar.perfil}">Editar Perfil</span>
        </a>
        <a th:href="${perfil.isAdmin() ? '/admin/perfil/cambiar-password' : '/arbitro/perfil/cambiar-password'}" 
           class="btn btn-primary">
            <span>üîí</span> <span th:text="#{perfil.cambiar.password}">Cambiar Contrase√±a</span>
        </a>
    </div>
</div>

</body>
</html>
