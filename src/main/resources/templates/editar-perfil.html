<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <title>[[#{editar.perfil.titulo}]] - CABA Pro</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{/css/perfil.css}" />
    <link rel="stylesheet" th:href="@{/css/formularios.css}" />
</head>
<body style="margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">

<div class="perfil-container">
    <!-- Header del formulario -->
    <div class="perfil-header">
        <h1><span>‚úèÔ∏è</span> <span th:text="#{editar.perfil.titulo}">Editar Perfil</span></h1>
        <p th:if="${esAdmin}" class="text-muted" th:text="#{cambiar.password.rol.admin}">Administrador del Sistema</p>
        <p th:if="${!esAdmin}" class="text-muted" th:text="#{cambiar.password.rol.arbitro}">√Årbitro Profesional</p>
    </div>

    <!-- Mostrar errores -->
    <div th:if="${error}" class="alert alert-error">
        <span th:text="${error}"></span>
    </div>

    <!-- Formulario de edici√≥n -->
    <form th:action="${esAdmin ? '/admin/perfil/editar' : '/arbitro/perfil/editar'}" 
          th:object="${editarPerfil}" 
          method="post" enctype="multipart/form-data">

        <!-- Informaci√≥n para Administrador -->
        <div th:if="${esAdmin}" class="info-section">
            <div class="info-title">
                <span>üîß</span> <span th:text="#{editar.perfil.admin.seccion}">Informaci√≥n del Administrador</span>
            </div>
            
            <div class="form-group">
                <label for="fotoPerfil" th:text="#{editar.perfil.foto}">Foto de Perfil</label>
                <input type="file" id="fotoPerfil" name="fotoPerfil" accept="image/*">
            </div>
            
            <div class="form-group">
                <label for="username" th:text="#{editar.perfil.admin.username}">Nombre de Usuario:</label>
                <input type="text" 
                       id="username" 
                       th:field="*{username}" 
                       class="form-control"
                       th:placeholder="#{editar.perfil.admin.username.placeholder}" />
                <span th:if="${#fields.hasErrors('username')}" 
                      th:errors="*{username}" 
                      class="error-message"></span>
            </div>
        </div>

        <!-- Informaci√≥n para √Årbitro -->
        <div th:if="${!esAdmin}" class="perfil-info">
            <div class="form-group">
                <label for="fotoPerfil" th:text="#{editar.perfil.foto}">Foto de Perfil</label>
                <input type="file" id="fotoPerfil" name="fotoPerfil" accept="image/*">
            </div>
            <!-- Informaci√≥n Personal -->
            <div class="info-section">
                <div class="info-title">
                    <span>üë§</span> <span th:text="#{editar.perfil.personal.seccion}">Informaci√≥n Personal</span>
                </div>
                
                <div class="form-group">
                    <label for="nombre" th:text="#{editar.perfil.personal.nombre}">Nombre:</label>
                    <input type="text" 
                           id="nombre" 
                           th:field="*{nombre}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.personal.nombre.placeholder}" />
                    <span th:if="${#fields.hasErrors('nombre')}" 
                          th:errors="*{nombre}" 
                          class="error-message"></span>
                </div>

                <div class="form-group">
                    <label for="apellidos" th:text="#{editar.perfil.personal.apellidos}">Apellidos:</label>
                    <input type="text" 
                           id="apellidos" 
                           th:field="*{apellidos}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.personal.apellidos.placeholder}" />
                    <span th:if="${#fields.hasErrors('apellidos')}" 
                          th:errors="*{apellidos}" 
                          class="error-message"></span>
                </div>

                <div class="form-group">
                    <label for="numeroIdentificacion" th:text="#{editar.perfil.personal.numero.id}">N√∫mero de Identificaci√≥n:</label>
                    <input type="text" 
                           id="numeroIdentificacion" 
                           th:field="*{numeroIdentificacion}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.personal.numero.id.placeholder}" />
                </div>

                <div class="form-group">
                    <label for="fechaNacimiento" th:text="#{editar.perfil.personal.fecha.nacimiento}">Fecha de Nacimiento:</label>
                    <input type="date" 
                           id="fechaNacimiento" 
                           th:field="*{fechaNacimiento}" 
                           class="form-control" />
                </div>
            </div>

            <!-- Informaci√≥n de Contacto -->
            <div class="info-section">
                <div class="info-title">
                    <span>üìß</span> <span th:text="#{editar.perfil.contacto.seccion}">Contacto</span>
                </div>
                
                <div class="form-group">
                    <label for="email" th:text="#{editar.perfil.contacto.email}">Email:</label>
                    <input type="email" 
                           id="email" 
                           th:field="*{email}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.contacto.email.placeholder}" />
                    <span th:if="${#fields.hasErrors('email')}" 
                          th:errors="*{email}" 
                          class="error-message"></span>
                </div>

                <div class="form-group">
                    <label for="telefono" th:text="#{editar.perfil.contacto.telefono}">Tel√©fono:</label>
                    <input type="tel" 
                           id="telefono" 
                           th:field="*{telefono}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.contacto.telefono.placeholder}" />
                </div>
            </div>

            <!-- Informaci√≥n Profesional -->
            <div class="info-section">
                <div class="info-title">
                    <span>‚öΩ</span> <span th:text="#{editar.perfil.profesional.seccion}">Informaci√≥n Profesional</span>
                </div>
                
                <div class="form-group">
                    <label for="especialidad" th:text="#{editar.perfil.profesional.especialidad}">Especialidad:</label>
                    <select id="especialidad" 
                            th:field="*{especialidad}" 
                            class="form-control">
                        <option value="" th:text="#{editar.perfil.profesional.especialidad.seleccionar}">Seleccione una especialidad</option>
                        <option th:each="esp : ${especialidades}" 
                                th:value="${esp}" 
                                th:text="${esp.descripcion}"></option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="escalafon" th:text="#{editar.perfil.profesional.escalafon}">Escalaf√≥n:</label>
                    <input type="text" 
                           id="escalafon" 
                           th:field="*{escalafon}" 
                           class="form-control"
                           th:placeholder="#{editar.perfil.profesional.escalafon.placeholder}" />
                </div>
            </div>
        </div>

        <!-- Estado com√∫n -->
        <div class="info-section">
            <div class="info-title">
                <span>‚öôÔ∏è</span> <span th:text="#{editar.perfil.estado.seccion}">Estado</span>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" 
                           th:field="*{activo}" 
                           class="form-checkbox" />
                    <span class="checkmark"></span>
                    <span th:text="#{editar.perfil.estado.activo}">Usuario Activo</span>
                </label>
                <small class="help-text" th:text="#{editar.perfil.estado.help}">Desmarque para establecer como "Ausente"</small>
            </div>
        </div>

        <!-- Botones de acci√≥n -->
        <div class="actions-section">
            <a th:href="${esAdmin ? '/admin/perfil' : '/arbitro/perfil'}" 
               class="btn btn-secondary"><span>‚ùå</span> <span th:text="#{btn.cancelar}">Cancelar</span></a>
            <button type="submit" class="btn btn-primary"><span>üíæ</span> <span th:text="#{editar.perfil.btn.guardar}">Guardar Cambios</span></button>
        </div>
    </form>
</div>

</body>
</html>
